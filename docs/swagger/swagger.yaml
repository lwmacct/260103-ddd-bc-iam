basePath: /
definitions:
  audit.AuditActionDTO:
    properties:
      action:
        description: '"user.create"'
        type: string
      category:
        description: '"user"'
        type: string
      description:
        description: '"Create new user"'
        type: string
      label:
        description: '"创建用户"'
        type: string
      operation:
        description: '"create"'
        type: string
    type: object
  audit.AuditActionsResponseDTO:
    properties:
      actions:
        description: 操作定义列表
        items:
          $ref: "#/definitions/audit.AuditActionDTO"
        type: array
      categories:
        description: 分类选项
        items:
          $ref: "#/definitions/audit.CategoryOptionDTO"
        type: array
      operations:
        description: 操作类型选项
        items:
          $ref: "#/definitions/audit.OperationTypeDTO"
        type: array
    type: object
  audit.AuditDTO:
    properties:
      action:
        type: string
      created_at:
        type: string
      details:
        type: string
      id:
        type: integer
      ip_address:
        type: string
      resource:
        type: string
      status:
        type: string
      user_agent:
        type: string
      user_id:
        type: integer
    type: object
  audit.CategoryOptionDTO:
    properties:
      label:
        description: '"用户管理"'
        type: string
      value:
        description: '"user"'
        type: string
    type: object
  audit.OperationTypeDTO:
    properties:
      label:
        description: '"创建"'
        type: string
      value:
        description: '"create"'
        type: string
    type: object
  auth.Login2FADTO:
    properties:
      session_token:
        description: 登录时返回的临时会话令牌
        example: eyJhbGciOiJIUzI1NiIs...
        type: string
      two_factor_code:
        description: 6位TOTP验证码
        example: "123456"
        type: string
    required:
      - session_token
      - two_factor_code
    type: object
  auth.LoginDTO:
    properties:
      account:
        description: 手机号/用户名/邮箱
        example: admin
        type: string
      captcha:
        description: 验证码
        example: "9999"
        type: string
      captcha_id:
        description: 验证码ID
        example: dev-123456
        type: string
      password:
        description: 密码
        example: admin123
        type: string
    required:
      - account
      - captcha
      - captcha_id
      - password
    type: object
  auth.LoginResponseDTO:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      requires_2fa:
        description: 2FA 相关（当需要 2FA 时返回）
        type: boolean
      session_token:
        type: string
      token_type:
        type: string
      user:
        $ref: "#/definitions/auth.UserBriefDTO"
    type: object
  auth.LoginRoleDTO:
    properties:
      id:
        type: integer
      name:
        type: string
    type: object
  auth.RefreshTokenDTO:
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    required:
      - refresh_token
    type: object
  auth.RegisterDTO:
    properties:
      email:
        example: john@example.com
        type: string
      nickname:
        example: Johnny
        maxLength: 50
        type: string
      password:
        example: password123
        minLength: 6
        type: string
      phone:
        example: "13800138000"
        type: string
      real_name:
        example: John Doe
        maxLength: 100
        type: string
      signature:
        example: Hello World
        maxLength: 255
        type: string
      username:
        example: john_doe
        maxLength: 50
        minLength: 3
        type: string
    required:
      - email
      - password
      - username
    type: object
  auth.RegisterResultDTO:
    properties:
      access_token:
        type: string
      email:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
      user_id:
        type: integer
      username:
        type: string
    type: object
  auth.TokenDTO:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
    type: object
  auth.UserBriefDTO:
    properties:
      roles:
        items:
          $ref: "#/definitions/auth.LoginRoleDTO"
        type: array
      user_id:
        type: integer
      username:
        type: string
    type: object
  captcha.GenerateResultDTO:
    properties:
      code:
        description: Code 验证码值（仅开发模式返回）
        type: string
      expire_at:
        description: ExpireAt 过期时间戳（秒）
        type: integer
      id:
        description: ID 验证码ID
        type: string
      image:
        description: Image Base64编码的图片
        type: string
    type: object
  handler.BatchSetItem:
    properties:
      key:
        type: string
      value: {}
    required:
      - key
      - value
    type: object
  handler.BatchSetRequest:
    properties:
      settings:
        items:
          $ref: "#/definitions/handler.BatchSetItem"
        minItems: 1
        type: array
    required:
      - settings
    type: object
  handler.SetRequest:
    properties:
      value: {}
    required:
      - value
    type: object
  handler.UpdateProfileRequest:
    properties:
      avatar:
        example: https://example.com/avatar.jpg
        maxLength: 255
        type: string
      bio:
        example: 这是我的个人简介
        type: string
      nickname:
        example: 小三
        maxLength: 50
        type: string
      phone:
        example: "13800138000"
        type: string
      real_name:
        example: 张三
        maxLength: 100
        type: string
      signature:
        example: Hello World
        maxLength: 255
        type: string
    type: object
  org.AddMemberDTO:
    properties:
      role:
        enum:
          - owner
          - admin
          - member
        type: string
      user_id:
        type: integer
    required:
      - role
      - user_id
    type: object
  org.CreateOrgDTO:
    properties:
      avatar:
        maxLength: 255
        type: string
      description:
        maxLength: 500
        type: string
      display_name:
        maxLength: 100
        minLength: 2
        type: string
      name:
        maxLength: 50
        minLength: 2
        type: string
    required:
      - display_name
      - name
    type: object
  org.CreateTeamDTO:
    properties:
      avatar:
        maxLength: 255
        type: string
      description:
        maxLength: 500
        type: string
      display_name:
        maxLength: 100
        minLength: 2
        type: string
      name:
        maxLength: 50
        minLength: 2
        type: string
    required:
      - display_name
      - name
    type: object
  org.DependsOnDTO:
    properties:
      key:
        type: string
      value: {}
    type: object
  org.MemberDTO:
    properties:
      avatar:
        type: string
      email:
        type: string
      full_name:
        type: string
      id:
        type: integer
      joined_at:
        type: string
      org_id:
        type: integer
      role:
        type: string
      user_id:
        type: integer
      username:
        description: 关联的用户信息（可选加载）
        type: string
    type: object
  org.OrgDTO:
    properties:
      avatar:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      name:
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  org.OrgSettingDTO:
    properties:
      category_id:
        type: integer
      default_value:
        description: 系统默认值
      group:
        type: string
      input_type:
        type: string
      is_customized:
        description: 是否组织自定义
        type: boolean
      key:
        type: string
      label:
        type: string
      order:
        type: integer
      ui_config:
        $ref: "#/definitions/org.UIConfigDTO"
      validation:
        type: string
      value:
        description: 实际生效值（组织值 > 默认值）
      value_type:
        type: string
    type: object
  org.SelectOptionDTO:
    properties:
      label:
        type: string
      value: {}
    type: object
  org.TeamDTO:
    properties:
      avatar:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      name:
        type: string
      org_id:
        type: integer
      updated_at:
        type: string
    type: object
  org.TeamMemberDTO:
    properties:
      avatar:
        type: string
      email:
        type: string
      full_name:
        type: string
      id:
        type: integer
      joined_at:
        type: string
      role:
        type: string
      team_id:
        type: integer
      user_id:
        type: integer
      username:
        description: 关联的用户信息（可选加载）
        type: string
    type: object
  org.UIConfigDTO:
    properties:
      depends_on:
        $ref: "#/definitions/org.DependsOnDTO"
      hint:
        type: string
      options:
        items:
          $ref: "#/definitions/org.SelectOptionDTO"
        type: array
    type: object
  org.UpdateMemberRoleDTO:
    properties:
      role:
        enum:
          - owner
          - admin
          - member
        type: string
    required:
      - role
    type: object
  org.UpdateOrgDTO:
    properties:
      avatar:
        maxLength: 255
        type: string
      description:
        maxLength: 500
        type: string
      display_name:
        maxLength: 100
        minLength: 2
        type: string
      status:
        enum:
          - active
          - suspended
        type: string
    type: object
  org.UserOrgDTO:
    properties:
      avatar:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      joined_at:
        description: 加入时间
        type: string
      name:
        type: string
      role:
        description: 用户在该组织中的角色
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  org.UserTeamDTO:
    properties:
      avatar:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      joined_at:
        description: 加入时间
        type: string
      name:
        type: string
      org_id:
        type: integer
      org_name:
        description: 所属组织名称
        type: string
      role:
        description: 用户在该团队中的角色
        type: string
      updated_at:
        type: string
    type: object
  pat.CreateDTO:
    properties:
      description:
        description: 可选，备注
        type: string
      expires_at:
        description: 可选，过期时间（RFC3339 或 yyyy-MM-ddTHH:mm）
        type: string
      expires_in:
        description: 可选，以天为单位的有效期（兜底，前端未使用时可忽略）
        type: integer
      ip_whitelist:
        description: 可选，IP 白名单
        items:
          type: string
        type: array
      name:
        maxLength: 100
        minLength: 3
        type: string
      scopes:
        description: 权限范围（full, self, sys），默认 ["full"]
        items:
          type: string
        type: array
    required:
      - name
    type: object
  pat.CreateResultDTO:
    properties:
      plain_token:
        type: string
      token:
        $ref: "#/definitions/pat.TokenDTO"
    type: object
  pat.ScopeInfoDTO:
    properties:
      description:
        type: string
      display_name:
        type: string
      name:
        type: string
    type: object
  pat.TokenDTO:
    properties:
      created_at:
        type: string
      expires_at:
        type: string
      id:
        type: integer
      ip_whitelist:
        items:
          type: string
        type: array
      last_used_at:
        type: string
      name:
        type: string
      scopes:
        items:
          type: string
        type: array
      status:
        type: string
      token_prefix:
        type: string
      updated_at:
        type: string
      user_id:
        type: integer
    type: object
  response.DataResponse-array_org_OrgSettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/org.OrgSettingDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_org_UserOrgDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/org.UserOrgDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_org_UserTeamDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/org.UserTeamDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_pat_ScopeInfoDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/pat.ScopeInfoDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_pat_TokenDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/pat.TokenDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_team_TeamSettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/team.TeamSettingDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_user_CategoryDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/user.CategoryDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_user_UserSettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: "#/definitions/user.UserSettingDTO"
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-audit_AuditActionsResponseDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/audit.AuditActionsResponseDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-audit_AuditDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/audit.AuditDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auth_LoginResponseDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/auth.LoginResponseDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auth_RegisterResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/auth.RegisterResultDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auth_TokenDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/auth.TokenDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-captcha_GenerateResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/captcha.GenerateResultDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-org_MemberDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/org.MemberDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-org_OrgDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/org.OrgDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-org_OrgSettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/org.OrgSettingDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-org_TeamDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/org.TeamDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-pat_CreateResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/pat.CreateResultDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-pat_TokenDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/pat.TokenDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-role_CreateResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/role.CreateResultDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-role_RoleDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/role.RoleDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-team_TeamSettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/team.TeamSettingDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-twofa_EnableDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/twofa.EnableDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-twofa_SetupDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/twofa.SetupDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-twofa_StatusDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/twofa.StatusDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-user_BatchCreateResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/user.BatchCreateResultDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-user_UserSettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/user.UserSettingDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-user_UserWithRolesDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
          - $ref: "#/definitions/user.UserWithRolesDTO"
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.ErrorDetail:
    properties:
      code:
        description: 业务错误码（小写下划线）
        type: string
      details:
        description: 额外详情（如验证错误列表）
      message:
        description: 错误消息
        type: string
    type: object
  response.ErrorResponse:
    properties:
      error:
        $ref: "#/definitions/response.ErrorDetail"
    type: object
  response.MessageResponse:
    description: 纯消息响应格式
    properties:
      code:
        description: HTTP 状态码
        type: integer
      message:
        description: 消息描述
        type: string
    type: object
  response.PagedResponse-audit_AuditDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/audit.AuditDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PagedResponse-org_MemberDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/org.MemberDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PagedResponse-org_OrgDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/org.OrgDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PagedResponse-org_TeamDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/org.TeamDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PagedResponse-org_TeamMemberDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/org.TeamMemberDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PagedResponse-role_RoleDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/role.RoleDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PagedResponse-user_UserWithRolesDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: "#/definitions/user.UserWithRolesDTO"
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
          - $ref: "#/definitions/response.PaginationMeta"
        description: 分页信息
    type: object
  response.PaginationMeta:
    properties:
      has_more:
        description: 是否有下一页
        type: boolean
      page:
        description: 当前页码
        type: integer
      per_page:
        description: 每页数量
        type: integer
      total:
        description: 总记录数
        type: integer
      total_pages:
        description: 总页数
        type: integer
      warning:
        description: 页码越界警告
        type: string
    type: object
  role.CreateDTO:
    properties:
      description:
        example: 系统开发人员角色
        maxLength: 255
        type: string
      display_name:
        example: 开发者
        maxLength: 100
        type: string
      name:
        example: developer
        maxLength: 50
        minLength: 2
        type: string
    required:
      - display_name
      - name
    type: object
  role.CreateResultDTO:
    properties:
      display_name:
        type: string
      name:
        type: string
      role_id:
        type: integer
    type: object
  role.PermissionDTO:
    properties:
      operation_pattern:
        example: sys:users.*
        type: string
      resource_pattern:
        example: user/*
        type: string
    type: object
  role.PermissionInputDTO:
    properties:
      operation_pattern:
        example: sys:users.*
        type: string
      resource_pattern:
        example: user/*
        type: string
    required:
      - operation_pattern
    type: object
  role.RoleDTO:
    properties:
      created_at:
        type: string
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      is_system:
        type: boolean
      name:
        type: string
      permissions:
        items:
          $ref: "#/definitions/role.PermissionDTO"
        type: array
      updated_at:
        type: string
    type: object
  role.SetPermissionsDTO:
    properties:
      permissions:
        items:
          $ref: "#/definitions/role.PermissionInputDTO"
        type: array
    required:
      - permissions
    type: object
  role.UpdateDTO:
    properties:
      description:
        maxLength: 255
        type: string
      display_name:
        maxLength: 100
        type: string
    type: object
  team.DependsOnDTO:
    properties:
      key:
        type: string
      value: {}
    type: object
  team.SelectOptionDTO:
    properties:
      label:
        type: string
      value: {}
    type: object
  team.TeamSettingDTO:
    properties:
      category_id:
        type: integer
      configurable_at:
        description: 最大可配置级别
        type: string
      default_value:
        description: 系统默认值
      group:
        type: string
      inherited_from:
        description: '继承来源: "team" | "org" | "system"'
        type: string
      input_type:
        type: string
      is_customized:
        description: 是否团队自定义
        type: boolean
      is_team_default:
        description: 是否为团队可配置的默认值（User 可覆盖）
        type: boolean
      key:
        type: string
      label:
        type: string
      order:
        type: integer
      org_value:
        description: 组织配置值
      ui_config:
        $ref: "#/definitions/team.UIConfigDTO"
      validation:
        type: string
      value:
        description: 实际生效值（团队 > 组织 > 默认值）
      value_type:
        type: string
      visible_at:
        description: 最小可见级别
        type: string
    type: object
  team.UIConfigDTO:
    properties:
      depends_on:
        $ref: "#/definitions/team.DependsOnDTO"
      hint:
        type: string
      options:
        items:
          $ref: "#/definitions/team.SelectOptionDTO"
        type: array
    type: object
  twofa.EnableDTO:
    properties:
      message:
        description: 提示消息
        type: string
      recovery_codes:
        description: 恢复码列表
        items:
          type: string
        type: array
    type: object
  twofa.SetupDTO:
    properties:
      qrcode_img:
        description: Base64 编码的二维码图片
        type: string
      qrcode_url:
        description: 二维码 URL
        type: string
      secret:
        description: TOTP 密钥（用户可手动输入）
        type: string
    type: object
  twofa.StatusDTO:
    properties:
      enabled:
        description: 是否启用
        type: boolean
      recovery_codes_count:
        description: 剩余恢复码数量
        type: integer
    type: object
  twofa.VerifyDTO:
    properties:
      code:
        description: TOTP 验证码
        example: "123456"
        type: string
    required:
      - code
    type: object
  user.AssignRolesDTO:
    properties:
      role_ids:
        items:
          type: integer
        type: array
    required:
      - role_ids
    type: object
  user.BatchCreateDTO:
    properties:
      users:
        items:
          $ref: "#/definitions/user.BatchItemDTO"
        maxItems: 100
        minItems: 1
        type: array
    required:
      - users
    type: object
  user.BatchCreateErrorDTO:
    properties:
      email:
        type: string
      error:
        type: string
      index:
        type: integer
      username:
        type: string
    type: object
  user.BatchCreateResultDTO:
    properties:
      errors:
        items:
          $ref: "#/definitions/user.BatchCreateErrorDTO"
        type: array
      failed:
        type: integer
      success:
        type: integer
      total:
        type: integer
    type: object
  user.BatchItemDTO:
    properties:
      email:
        type: string
      nickname:
        maxLength: 50
        type: string
      password:
        minLength: 6
        type: string
      phone:
        type: string
      real_name:
        maxLength: 100
        type: string
      role_ids:
        items:
          type: integer
        type: array
      signature:
        maxLength: 255
        type: string
      status:
        enum:
          - active
          - inactive
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    required:
      - email
      - password
      - username
    type: object
  user.CategoryDTO:
    properties:
      icon:
        type: string
      id:
        type: integer
      key:
        type: string
      label:
        type: string
      order:
        type: integer
    type: object
  user.ChangePasswordDTO:
    properties:
      new_password:
        minLength: 6
        type: string
      old_password:
        type: string
    required:
      - new_password
      - old_password
    type: object
  user.CreateDTO:
    properties:
      email:
        type: string
      nickname:
        maxLength: 50
        type: string
      password:
        minLength: 6
        type: string
      phone:
        type: string
      real_name:
        maxLength: 100
        type: string
      role_ids:
        items:
          type: integer
        type: array
      signature:
        maxLength: 255
        type: string
      status:
        enum:
          - active
          - inactive
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    required:
      - email
      - password
      - username
    type: object
  user.DependsOnDTO:
    properties:
      key:
        type: string
      value: {}
    type: object
  user.RoleDTO:
    properties:
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      name:
        type: string
    type: object
  user.SelectOptionDTO:
    properties:
      label:
        type: string
      value: {}
    type: object
  user.UIConfigDTO:
    properties:
      depends_on:
        $ref: "#/definitions/user.DependsOnDTO"
      hint:
        type: string
      options:
        items:
          $ref: "#/definitions/user.SelectOptionDTO"
        type: array
    type: object
  user.UpdateDTO:
    properties:
      avatar:
        maxLength: 255
        type: string
      bio:
        type: string
      email:
        type: string
      nickname:
        maxLength: 50
        type: string
      phone:
        type: string
      real_name:
        maxLength: 100
        type: string
      signature:
        maxLength: 255
        type: string
      status:
        enum:
          - active
          - inactive
          - banned
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    type: object
  user.UserSettingDTO:
    properties:
      category_id:
        type: integer
      default_value:
        description: 系统默认值
      group:
        type: string
      input_type:
        type: string
      is_customized:
        description: 是否用户自定义
        type: boolean
      key:
        type: string
      label:
        type: string
      order:
        type: integer
      ui_config:
        $ref: "#/definitions/user.UIConfigDTO"
      validation:
        type: string
      value:
        description: 实际生效值（用户值 > 默认值）
      value_type:
        type: string
    type: object
  user.UserWithRolesDTO:
    properties:
      avatar:
        type: string
      bio:
        type: string
      created_at:
        type: string
      email:
        type: string
      id:
        type: integer
      nickname:
        type: string
      phone:
        type: string
      real_name:
        type: string
      roles:
        items:
          $ref: "#/definitions/user.RoleDTO"
        type: array
      signature:
        type: string
      status:
        type: string
      type:
        description: '"human" | "service" | "system"'
        type: string
      updated_at:
        type: string
      username:
        type: string
    type: object
host: localhost:8080
info:
  contact:
    name: API Support
    url: https://github.com/lwmacct/260103-ddd-bc-iam
  description: 基于 DDD + CQRS 架构的可复用模块库
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: Go DDD Package Library API
  version: "1.0"
paths:
  /api/admin/audit:
    get:
      consumes:
        - application/json
      description: 分页获取审计日志，支持按用户、操作、资源、状态、时间范围筛选
      parameters:
        - description: Action 操作类型过滤（语义化标识，如 setting.update）
          in: query
          name: action
          type: string
        - description: EndDate 结束时间（RFC3339 格式）
          in: query
          name: end_date
          type: string
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
        - description: Resource 资源分类过滤（如 setting, user）
          in: query
          name: resource
          type: string
        - description: StartDate 开始时间（RFC3339 格式）
          in: query
          name: start_date
          type: string
        - description: Status 状态过滤
          enum:
            - success
            - failure
          in: query
          name: status
          type: string
        - description: UserID 按用户 ID 过滤
          in: query
          name: user_id
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 审计日志列表
          schema:
            $ref: "#/definitions/response.PagedResponse-audit_AuditDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 审计日志列表
      tags:
        - admin-audit
  /api/admin/audit/{id}:
    get:
      consumes:
        - application/json
      description: 根据日志ID获取审计日志详细信息
      parameters:
        - description: 日志ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 日志详情
          schema:
            $ref: "#/definitions/response.DataResponse-audit_AuditDTO"
        "400":
          description: 无效的日志ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 日志不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 审计日志详情
      tags:
        - admin-audit
  /api/admin/audit/actions:
    get:
      consumes:
        - application/json
      description: 获取所有审计操作的定义、分类和操作类型，供前端筛选器使用
      produces:
        - application/json
      responses:
        "200":
          description: 审计操作定义
          schema:
            $ref: "#/definitions/response.DataResponse-audit_AuditActionsResponseDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 审计操作定义
      tags:
        - admin-audit
  /api/admin/orgs:
    get:
      consumes:
        - application/json
      description: 分页获取所有组织
      parameters:
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
        - enum:
            - active
            - inactive
          in: query
          name: status
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 组织列表
          schema:
            $ref: "#/definitions/response.PagedResponse-org_OrgDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 组织列表
      tags:
        - admin-org
    post:
      consumes:
        - application/json
      description: 系统管理员创建新组织
      parameters:
        - description: 组织信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/org.CreateOrgDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 组织创建成功
          schema:
            $ref: "#/definitions/response.DataResponse-org_OrgDTO"
        "400":
          description: 参数错误或组织名已存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 创建组织
      tags:
        - admin-org
  /api/admin/orgs/{id}:
    delete:
      consumes:
        - application/json
      description: 软删除组织
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 组织删除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的组织ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 组织不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 删除组织
      tags:
        - admin-org
    get:
      consumes:
        - application/json
      description: 根据 ID 获取组织详情
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 组织详情
          schema:
            $ref: "#/definitions/response.DataResponse-org_OrgDTO"
        "400":
          description: 无效的组织ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 组织不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 组织详情
      tags:
        - admin-org
    put:
      consumes:
        - application/json
      description: 更新组织信息
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
        - description: 更新信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/org.UpdateOrgDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 组织更新成功
          schema:
            $ref: "#/definitions/response.DataResponse-org_OrgDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 组织不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 更新组织
      tags:
        - admin-org
  /api/admin/roles:
    get:
      consumes:
        - application/json
      description: 分页获取所有系统角色
      parameters:
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 角色列表
          schema:
            $ref: "#/definitions/response.PagedResponse-role_RoleDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 角色列表
      tags:
        - admin-role
    post:
      consumes:
        - application/json
      description: 管理员创建新的系统角色
      parameters:
        - description: 角色信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/role.CreateDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 角色创建成功
          schema:
            $ref: "#/definitions/response.DataResponse-role_CreateResultDTO"
        "400":
          description: 参数错误或角色名已存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 创建角色
      tags:
        - admin-role
  /api/admin/roles/{id}:
    delete:
      consumes:
        - application/json
      description: 管理员删除指定角色（如果角色被用户使用，可能会失败）
      parameters:
        - description: 角色ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 角色删除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的角色ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 角色不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误或角色被使用中
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 删除角色
      tags:
        - admin-role
    get:
      consumes:
        - application/json
      description: 根据角色ID获取角色详细信息（包含权限列表）
      parameters:
        - description: 角色ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 角色详情
          schema:
            $ref: "#/definitions/response.DataResponse-role_RoleDTO"
        "400":
          description: 无效的角色ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 角色不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 角色详情
      tags:
        - admin-role
    put:
      consumes:
        - application/json
      description: 管理员更新角色的显示名称和描述
      parameters:
        - description: 角色ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
        - description: 更新信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/role.UpdateDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 角色更新成功
          schema:
            $ref: "#/definitions/response.DataResponse-role_RoleDTO"
        "400":
          description: 无效的角色ID或参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 角色不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 更新角色
      tags:
        - admin-role
  /api/admin/roles/{id}/permissions:
    put:
      consumes:
        - application/json
      description: 管理员为指定角色设置权限（会覆盖现有权限）。新 RBAC 模型使用 Operation + Resource Pattern。
      parameters:
        - description: 角色ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
        - description: 权限模式列表
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/role.SetPermissionsDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 权限设置成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的角色ID或参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 角色不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 设置权限
      tags:
        - admin-role
  /api/admin/users:
    get:
      consumes:
        - application/json
      description: 分页获取所有用户列表（包含角色信息）
      parameters:
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
        - description: Search 搜索关键词（用户名或邮箱）
          in: query
          name: search
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 用户列表
          schema:
            $ref: "#/definitions/response.PagedResponse-user_UserWithRolesDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 用户列表
      tags:
        - admin-user
    post:
      consumes:
        - application/json
      description: 管理员创建新用户账号，可同时分配角色
      parameters:
        - description: 用户信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/user.CreateDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 用户创建成功
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserWithRolesDTO"
        "400":
          description: 参数错误或用户名/邮箱已存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 创建用户
      tags:
        - admin-user
  /api/admin/users/{id}:
    delete:
      consumes:
        - application/json
      description: 管理员删除指定用户（物理删除或软删除）
      parameters:
        - description: 用户ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 用户删除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的用户ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 用户不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 删除用户
      tags:
        - admin-user
    get:
      consumes:
        - application/json
      description: 根据用户ID获取用户详细信息（包含角色信息）
      parameters:
        - description: 用户ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 用户详情
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserWithRolesDTO"
        "400":
          description: 无效的用户ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 用户不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 用户详情
      tags:
        - admin-user
    put:
      consumes:
        - application/json
      description: 管理员更新用户的基本信息和状态
      parameters:
        - description: 用户ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
        - description: 更新信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/user.UpdateDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 用户更新成功
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserWithRolesDTO"
        "400":
          description: 无效的用户ID或参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 用户不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 更新用户
      tags:
        - admin-user
  /api/admin/users/{id}/roles:
    put:
      consumes:
        - application/json
      description: 管理员为指定用户分配角色（会覆盖现有角色）
      parameters:
        - description: 用户ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
        - description: 角色ID列表
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/user.AssignRolesDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 角色分配成功
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserWithRolesDTO"
        "400":
          description: 无效的用户ID或参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 用户不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 分配角色
      tags:
        - admin-user
  /api/admin/users/batch:
    post:
      consumes:
        - application/json
      description: 管理员从 CSV 等来源批量创建用户，支持部分失败（单个失败不影响其他用户）
      parameters:
        - description: 用户列表（最多 100 个）
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/user.BatchCreateDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 批量创建结果
          schema:
            $ref: "#/definitions/response.DataResponse-user_BatchCreateResultDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 批量创建用户
      tags:
        - admin-user
  /api/auth/2fa/disable:
    post:
      consumes:
        - application/json
      description: 禁用当前用户的两步验证功能
      produces:
        - application/json
      responses:
        "200":
          description: 2FA禁用成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 禁用失败
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 禁用 2FA
      tags:
        - auth-2fa
  /api/auth/2fa/setup:
    post:
      consumes:
        - application/json
      description: 为当前用户生成2FA密钥和二维码，用于配置身份验证器应用
      produces:
        - application/json
      responses:
        "200":
          description: 2FA初始化成功
          schema:
            $ref: "#/definitions/response.DataResponse-twofa_SetupDTO"
        "400":
          description: 设置失败
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 设置 2FA
      tags:
        - auth-2fa
  /api/auth/2fa/status:
    get:
      consumes:
        - application/json
      description: 获取当前用户的2FA启用状态和剩余恢复代码数量
      produces:
        - application/json
      responses:
        "200":
          description: 2FA状态
          schema:
            $ref: "#/definitions/response.DataResponse-twofa_StatusDTO"
        "400":
          description: 获取失败
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 2FA 状态
      tags:
        - auth-2fa
  /api/auth/2fa/verify:
    post:
      consumes:
        - application/json
      description: 验证身份验证器应用生成的TOTP代码，成功后启用2FA并返回恢复代码
      parameters:
        - description: TOTP验证码
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/twofa.VerifyDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 2FA启用成功
          schema:
            $ref: "#/definitions/response.DataResponse-twofa_EnableDTO"
        "400":
          description: 验证码错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 启用 2FA
      tags:
        - auth-2fa
  /api/auth/captcha:
    get:
      consumes:
        - application/json
      description: 生成图形验证码用于登录。支持开发模式（通过code和secret参数指定验证码值）
      parameters:
        - description: 开发模式：指定验证码值
          in: query
          name: code
          type: string
        - description: 开发模式：密钥
          in: query
          name: secret
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 验证码生成成功
          schema:
            $ref: "#/definitions/response.DataResponse-captcha_GenerateResultDTO"
        "500":
          description: 生成失败
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      summary: 获取验证码
      tags:
        - auth
  /api/auth/login:
    post:
      consumes:
        - application/json
      description: 使用手机号/用户名/邮箱和密码登录系统，需要提供图形验证码。如果启用了2FA，返回session_token用于后续2FA验证
      parameters:
        - description: 登录凭证
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/auth.LoginDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 登录成功或需要2FA验证
          schema:
            $ref: "#/definitions/response.DataResponse-auth_LoginResponseDTO"
        "401":
          description: 登录失败：凭证无效、验证码错误或账户被禁用
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      summary: 登录
      tags:
        - auth
  /api/auth/login/2fa:
    post:
      consumes:
        - application/json
      description: 使用session_token和2FA验证码完成登录（适用于启用了2FA的账户）
      parameters:
        - description: 二次认证凭证
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/auth.Login2FADTO"
      produces:
        - application/json
      responses:
        "200":
          description: 登录成功
          schema:
            $ref: "#/definitions/response.DataResponse-auth_TokenDTO"
        "401":
          description: 验证失败：session_token无效或2FA验证码错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      summary: 2FA 登录
      tags:
        - auth
  /api/auth/refresh:
    post:
      consumes:
        - application/json
      description: 使用refresh_token获取新的access_token和refresh_token，延长会话有效期
      parameters:
        - description: 刷新令牌
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/auth.RefreshTokenDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 令牌刷新成功
          schema:
            $ref: "#/definitions/response.DataResponse-auth_LoginResponseDTO"
        "401":
          description: 刷新令牌无效或已过期
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 刷新令牌
      tags:
        - auth
  /api/auth/register:
    post:
      consumes:
        - application/json
      description: 创建新用户账号，注册成功后自动登录并返回访问令牌
      parameters:
        - description: 注册信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/auth.RegisterDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 注册成功
          schema:
            $ref: "#/definitions/response.DataResponse-auth_RegisterResultDTO"
        "400":
          description: 参数错误或用户名/邮箱已存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      summary: 注册
      tags:
        - auth
  /api/org/{org_id}/members:
    get:
      consumes:
        - application/json
      description: 分页获取组织成员列表
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 成员列表
          schema:
            $ref: "#/definitions/response.PagedResponse-org_MemberDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 成员列表
      tags:
        - org-member
    post:
      consumes:
        - application/json
      description: 添加用户到组织
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 成员信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/org.AddMemberDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 成员添加成功
          schema:
            $ref: "#/definitions/response.DataResponse-org_MemberDTO"
        "400":
          description: 参数错误或成员已存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 添加成员
      tags:
        - org-member
  /api/org/{org_id}/members/{user_id}:
    delete:
      consumes:
        - application/json
      description: 从组织中移除成员
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 用户ID
          in: path
          minimum: 1
          name: user_id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 成员移除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的ID或无法移除最后的所有者
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 成员不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 移除成员
      tags:
        - org-member
  /api/org/{org_id}/members/{user_id}/role:
    put:
      consumes:
        - application/json
      description: 更新组织成员的角色
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 用户ID
          in: path
          minimum: 1
          name: user_id
          required: true
          type: integer
        - description: 角色信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/org.UpdateMemberRoleDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 角色更新成功
          schema:
            $ref: "#/definitions/response.DataResponse-org_MemberDTO"
        "400":
          description: 参数错误或无法降级最后的所有者
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 成员不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 更新成员角色
      tags:
        - org-member
  /api/org/{org_id}/settings:
    get:
      consumes:
        - application/json
      description: 获取当前组织的配置列表（系统默认值+组织自定义值合并视图）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 从上下文获取，不绑定
          in: query
          name: "-"
          type: integer
        - description: 可选：按分类 ID 过滤
          in: query
          name: category_id
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 配置列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_org_OrgSettingDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 组织配置列表
      tags:
        - settings-org
  /api/org/{org_id}/settings/{key}:
    delete:
      consumes:
        - application/json
      description: 重置指定配置项（删除组织自定义值，恢复系统默认值）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 重置成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 重置组织配置
      tags:
        - settings-org
    get:
      consumes:
        - application/json
      description: 获取指定配置项的值（系统默认值或组织自定义值）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 配置信息
          schema:
            $ref: "#/definitions/response.DataResponse-org_OrgSettingDTO"
        "400":
          description: 无效的键名
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 配置不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 获取组织配置
      tags:
        - settings-org
    put:
      consumes:
        - application/json
      description: 设置指定配置项的值（组织自定义覆盖）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
        - description: 设置请求
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/handler.SetRequest"
      produces:
        - application/json
      responses:
        "200":
          description: 设置成功
          schema:
            $ref: "#/definitions/response.DataResponse-org_OrgSettingDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 设置组织配置
      tags:
        - settings-org
  /api/org/{org_id}/teams:
    get:
      consumes:
        - application/json
      description: 分页获取组织内的团队列表
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 团队列表
          schema:
            $ref: "#/definitions/response.PagedResponse-org_TeamDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 团队列表
      tags:
        - org-team
    post:
      consumes:
        - application/json
      description: 在组织内创建新团队
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 团队信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/org.CreateTeamDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 团队创建成功
          schema:
            $ref: "#/definitions/response.DataResponse-org_TeamDTO"
        "400":
          description: 参数错误或团队名已存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 创建团队
      tags:
        - org-team
  /api/org/{org_id}/teams/{team_id}:
    delete:
      consumes:
        - application/json
      description: 软删除团队
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          minimum: 1
          name: team_id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 团队删除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 团队不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 删除团队
      tags:
        - org-team
    get:
      consumes:
        - application/json
      description: 获取团队详情
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          minimum: 1
          name: team_id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 团队详情
          schema:
            $ref: "#/definitions/response.DataResponse-org_TeamDTO"
        "400":
          description: 无效的ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 团队不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 团队详情
      tags:
        - org-team
  /api/org/{org_id}/teams/{team_id}/members:
    get:
      consumes:
        - application/json
      description: 分页获取团队成员列表
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          minimum: 1
          name: team_id
          required: true
          type: integer
        - default: 20
          description: Limit 每页数量，默认 20，最大 1000
          in: query
          maximum: 1000
          minimum: 1
          name: limit
          type: integer
        - default: 1
          description: Page 页码，从 1 开始
          in: query
          minimum: 1
          name: page
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 成员列表
          schema:
            $ref: "#/definitions/response.PagedResponse-org_TeamMemberDTO"
        "400":
          description: 无效的ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 团队成员列表
      tags:
        - org-team-member
  /api/org/{org_id}/teams/{team_id}/members/{user_id}:
    delete:
      consumes:
        - application/json
      description: 从团队中移除成员
      parameters:
        - description: 组织ID
          in: path
          minimum: 1
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          minimum: 1
          name: team_id
          required: true
          type: integer
        - description: 用户ID
          in: path
          minimum: 1
          name: user_id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 成员移除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 成员不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 移除团队成员
      tags:
        - org-team-member
  /api/org/{org_id}/teams/{team_id}/settings:
    get:
      consumes:
        - application/json
      description: 获取当前团队的配置列表（支持三级继承：团队>组织>系统默认值）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          name: team_id
          required: true
          type: integer
        - description: 从上下文获取，不绑定
          in: query
          name: "-"
          type: integer
        - description: 可选：按分类 ID 过滤
          in: query
          name: category_id
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 配置列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_team_TeamSettingDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 团队配置列表
      tags:
        - settings-team
  /api/org/{org_id}/teams/{team_id}/settings/{key}:
    delete:
      consumes:
        - application/json
      description: 重置指定配置项（删除团队自定义值，恢复组织配置或系统默认值）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          name: team_id
          required: true
          type: integer
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 重置成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 重置团队配置
      tags:
        - settings-team
    get:
      consumes:
        - application/json
      description: 获取指定配置项的值（支持三级继承：团队>组织>系统默认值）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          name: team_id
          required: true
          type: integer
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 配置信息
          schema:
            $ref: "#/definitions/response.DataResponse-team_TeamSettingDTO"
        "400":
          description: 无效的键名
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 配置不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 获取团队配置
      tags:
        - settings-team
    put:
      consumes:
        - application/json
      description: 设置指定配置项的值（团队自定义覆盖）
      parameters:
        - description: 组织ID
          in: path
          name: org_id
          required: true
          type: integer
        - description: 团队ID
          in: path
          name: team_id
          required: true
          type: integer
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
        - description: 设置请求
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/handler.SetRequest"
      produces:
        - application/json
      responses:
        "200":
          description: 设置成功
          schema:
            $ref: "#/definitions/response.DataResponse-team_TeamSettingDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "403":
          description: 权限不足
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 设置团队配置
      tags:
        - settings-team
  /api/user/account:
    delete:
      consumes:
        - application/json
      description: 用户删除自己的账号（不可恢复）
      produces:
        - application/json
      responses:
        "200":
          description: 账号删除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 注销账户
      tags:
        - user-profile
  /api/user/orgs:
    get:
      consumes:
        - application/json
      description: 获取当前用户加入的所有组织
      produces:
        - application/json
      responses:
        "200":
          description: 组织列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_org_UserOrgDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 我的组织
      tags:
        - user-org
  /api/user/password:
    put:
      consumes:
        - application/json
      description: 用户修改自己的登录密码
      parameters:
        - description: 密码信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/user.ChangePasswordDTO"
      produces:
        - application/json
      responses:
        "200":
          description: 密码修改成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 参数错误或旧密码不正确
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 修改密码
      tags:
        - user-profile
  /api/user/profile:
    get:
      consumes:
        - application/json
      description: 获取当前登录用户的个人资料和角色信息
      produces:
        - application/json
      responses:
        "200":
          description: 个人资料
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserWithRolesDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 用户不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 获取资料
      tags:
        - user-profile
    put:
      consumes:
        - application/json
      description: 用户更新自己的姓名、头像和个人简介
      parameters:
        - description: 更新信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/handler.UpdateProfileRequest"
      produces:
        - application/json
      responses:
        "200":
          description: 资料更新成功
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserWithRolesDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 更新资料
      tags:
        - user-profile
  /api/user/settings:
    get:
      consumes:
        - application/json
      description: 获取当前用户的配置列表（系统默认值+用户自定义值合并视图）
      parameters:
        - description: 从上下文获取，不绑定
          in: query
          name: "-"
          type: integer
        - description: 可选：按分类 ID 过滤
          in: query
          name: category_id
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 配置列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_user_UserSettingDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 配置列表
      tags:
        - settings-user
  /api/user/settings/{key}:
    delete:
      consumes:
        - application/json
      description: 重置指定配置项（删除用户自定义值，恢复系统默认值）
      parameters:
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 重置成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 重置配置
      tags:
        - settings-user
    get:
      consumes:
        - application/json
      description: 获取指定配置项的值（系统默认值或用户自定义值）
      parameters:
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
      produces:
        - application/json
      responses:
        "200":
          description: 配置信息
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserSettingDTO"
        "400":
          description: 无效的键名
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 配置不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 获取配置
      tags:
        - settings-user
    put:
      consumes:
        - application/json
      description: 设置指定配置项的值（用户自定义覆盖）
      parameters:
        - description: 配置键名
          in: path
          name: key
          required: true
          type: string
        - description: 设置请求
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/handler.SetRequest"
      produces:
        - application/json
      responses:
        "200":
          description: 设置成功
          schema:
            $ref: "#/definitions/response.DataResponse-user_UserSettingDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 设置配置
      tags:
        - settings-user
  /api/user/settings/batch:
    post:
      consumes:
        - application/json
      description: 批量设置多个配置项的值
      parameters:
        - description: 批量设置请求
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/handler.BatchSetRequest"
      produces:
        - application/json
      responses:
        "200":
          description: 设置成功
          schema:
            $ref: "#/definitions/response.DataResponse-array_user_UserSettingDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 批量设置
      tags:
        - settings-user
  /api/user/settings/categories:
    get:
      consumes:
        - application/json
      description: 获取配置分类列表
      produces:
        - application/json
      responses:
        "200":
          description: 分类列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_user_CategoryDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 分类列表
      tags:
        - settings-user
  /api/user/settings/reset-all:
    post:
      consumes:
        - application/json
      description: 重置所有用户自定义配置（恢复系统默认值）
      produces:
        - application/json
      responses:
        "200":
          description: 重置成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 重置所有配置
      tags:
        - settings-user
  /api/user/teams:
    get:
      consumes:
        - application/json
      description: 获取当前用户加入的所有团队（可按组织筛选）
      parameters:
        - in: query
          minimum: 1
          name: org_id
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 团队列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_org_UserTeamDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 我的团队
      tags:
        - user-org
  /api/user/tokens:
    get:
      consumes:
        - application/json
      description: 获取当前用户的所有个人访问令牌（不包含令牌值）
      produces:
        - application/json
      responses:
        "200":
          description: 令牌列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_pat_TokenDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "500":
          description: 服务器内部错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 令牌列表
      tags:
        - user-pat
    post:
      consumes:
        - application/json
      description: 用户创建新的个人访问令牌(PAT)，用于API访问。令牌仅在创建时显示一次
      parameters:
        - description: 令牌信息
          in: body
          name: request
          required: true
          schema:
            $ref: "#/definitions/pat.CreateDTO"
      produces:
        - application/json
      responses:
        "201":
          description: 令牌创建成功
          schema:
            $ref: "#/definitions/response.DataResponse-pat_CreateResultDTO"
        "400":
          description: 参数错误
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 创建令牌
      tags:
        - user-pat
  /api/user/tokens/{id}:
    delete:
      consumes:
        - application/json
      description: 用户删除指定的个人访问令牌（不可恢复）
      parameters:
        - description: 令牌ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 令牌删除成功
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的令牌ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 令牌不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 删除令牌
      tags:
        - user-pat
    get:
      consumes:
        - application/json
      description: 获取指定个人访问令牌的详细信息（不包含令牌值）
      parameters:
        - description: 令牌ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 令牌详情
          schema:
            $ref: "#/definitions/response.DataResponse-pat_TokenDTO"
        "400":
          description: 无效的令牌ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "404":
          description: 令牌不存在
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 令牌详情
      tags:
        - user-pat
  /api/user/tokens/{id}/disable:
    patch:
      consumes:
        - application/json
      description: 暂停指定令牌的使用（可再次启用）
      parameters:
        - description: 令牌ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 令牌已禁用
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的令牌ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 禁用令牌
      tags:
        - user-pat
  /api/user/tokens/{id}/enable:
    patch:
      consumes:
        - application/json
      description: 重新启用已禁用的令牌
      parameters:
        - description: 令牌ID
          in: path
          minimum: 1
          name: id
          required: true
          type: integer
      produces:
        - application/json
      responses:
        "200":
          description: 令牌已启用
          schema:
            $ref: "#/definitions/response.MessageResponse"
        "400":
          description: 无效的令牌ID
          schema:
            $ref: "#/definitions/response.ErrorResponse"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: 启用令牌
      tags:
        - user-pat
  /api/user/tokens/scopes:
    get:
      consumes:
        - application/json
      description: 获取创建 PAT 时可选的权限范围列表
      produces:
        - application/json
      responses:
        "200":
          description: Scope 列表
          schema:
            $ref: "#/definitions/response.DataResponse-array_pat_ScopeInfoDTO"
        "401":
          description: 未授权
          schema:
            $ref: "#/definitions/response.ErrorResponse"
      security:
        - BearerAuth: []
      summary: Scope 列表
      tags:
        - user-pat
securityDefinitions:
  BearerAuth:
    description: Bearer token authentication
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
